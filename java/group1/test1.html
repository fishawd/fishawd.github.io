<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JAVA基础 | 游鱼惊梦</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="分享学习">
    <meta name="robots" content="all">
    <meta name="author" content="游鱼惊梦">
    <meta name="keywords" content="java, python, 算法, 学习, 总结, 教程">
    <link rel="preload" href="/assets/css/0.styles.1ce93e4e.css" as="style"><link rel="preload" href="/assets/js/app.c4ea1501.js" as="script"><link rel="preload" href="/assets/js/2.edc735c2.js" as="script"><link rel="preload" href="/assets/js/29.49e6c8d3.js" as="script"><link rel="prefetch" href="/assets/js/10.6a65e278.js"><link rel="prefetch" href="/assets/js/11.87bbf373.js"><link rel="prefetch" href="/assets/js/12.ad445641.js"><link rel="prefetch" href="/assets/js/13.3589a423.js"><link rel="prefetch" href="/assets/js/14.2f6af986.js"><link rel="prefetch" href="/assets/js/15.d46f431c.js"><link rel="prefetch" href="/assets/js/16.33d62059.js"><link rel="prefetch" href="/assets/js/17.8ec4d1d5.js"><link rel="prefetch" href="/assets/js/18.e0725736.js"><link rel="prefetch" href="/assets/js/19.c6ce94d1.js"><link rel="prefetch" href="/assets/js/20.7204d161.js"><link rel="prefetch" href="/assets/js/21.0eb85fe9.js"><link rel="prefetch" href="/assets/js/22.4eb578f5.js"><link rel="prefetch" href="/assets/js/23.d7b00fec.js"><link rel="prefetch" href="/assets/js/24.38916880.js"><link rel="prefetch" href="/assets/js/25.31c14213.js"><link rel="prefetch" href="/assets/js/26.44496f06.js"><link rel="prefetch" href="/assets/js/27.542441f5.js"><link rel="prefetch" href="/assets/js/28.6c751205.js"><link rel="prefetch" href="/assets/js/3.d33dba2e.js"><link rel="prefetch" href="/assets/js/30.2eb90dee.js"><link rel="prefetch" href="/assets/js/4.950372b8.js"><link rel="prefetch" href="/assets/js/5.f883b629.js"><link rel="prefetch" href="/assets/js/6.6b6c3c23.js"><link rel="prefetch" href="/assets/js/7.94c78b90.js"><link rel="prefetch" href="/assets/js/8.315c3c9e.js"><link rel="prefetch" href="/assets/js/9.27e176ae.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1ce93e4e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">游鱼惊梦</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithm/datastructure/algo-ds-linklist.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/algorithm/common/algo-common-dp.html" class="nav-link">
  常用算法
</a></li><li class="dropdown-item"><!----> <a href="/algorithm/special-package/algo-package-01.html" class="nav-link">
  背包专题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础知识" class="dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basedata/designpattern/base-designpattern-desc.html" class="nav-link">
  设计模式
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithm/datastructure/algo-ds-linklist.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/algorithm/common/algo-common-dp.html" class="nav-link">
  常用算法
</a></li><li class="dropdown-item"><!----> <a href="/algorithm/special-package/algo-package-01.html" class="nav-link">
  背包专题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础知识" class="dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basedata/designpattern/base-designpattern-desc.html" class="nav-link">
  设计模式
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>集合框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java/group1/test1.html" class="active sidebar-link">JAVA基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/group1/test1.html#java-web基础" class="sidebar-link">JAVA Web基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/group1/test1.html#http协议" class="sidebar-link">HTTP协议</a></li><li class="sidebar-sub-header"><a href="/java/group1/test1.html#tomcat" class="sidebar-link">Tomcat</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/group1/test1.html#java进阶" class="sidebar-link">JAVA进阶</a></li><li class="sidebar-sub-header"><a href="/java/group1/test1.html#java-web进阶" class="sidebar-link">JAVA Web进阶</a></li><li class="sidebar-sub-header"><a href="/java/group1/test1.html#redis，linux-docker等" class="sidebar-link">redis，linux, docker等</a></li><li class="sidebar-sub-header"><a href="/java/group1/test1.html#其他：" class="sidebar-link">其他：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/group1/test1.html#算法" class="sidebar-link">算法</a></li></ul></li></ul></li><li><a href="/java/group1/two.html" class="sidebar-link">two</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>IO/NIO/AIO</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java/spring/test2.html" class="sidebar-link">测试2</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="java基础"><a href="#java基础" class="header-anchor">#</a> JAVA基础</h1> <p></p><div class="table-of-contents"><ul><li><a href="#java基础">JAVA基础</a><ul><li><a href="#io-nio-aio">IO, NIO, AIO</a><ul><li><a href="#io">IO</a></li><li><a href="#序列化">序列化</a></li><li><a href="#nio">NIO</a></li><li><a href="#aio">AIO</a></li></ul></li><li><a href="#泛型">泛型</a></li><li><a href="#并发">并发</a></li><li><a href="#反射">反射</a></li><li><a href="#代理">代理</a></li><li><a href="#集合">集合</a><ul><li><a href="#collection">Collection</a></li><li><a href="#map">Map</a></li></ul></li></ul><ul><li><a href="#java-web基础">JAVA Web基础</a><ul><li><a href="#http协议">HTTP协议</a></li><li><a href="#tomcat">Tomcat</a></li></ul></li><li><a href="#java进阶">JAVA进阶</a></li><li><a href="#java-web进阶">JAVA Web进阶</a></li><li><a href="#redis，linux-docker等">redis，linux, docker等</a></li><li><a href="#其他：">其他：</a><ul><li><a href="#算法">算法</a></li></ul></li></ul></li></ul></div><p></p> <h3 id="io-nio-aio"><a href="#io-nio-aio" class="header-anchor">#</a> IO, NIO, AIO</h3> <h4 id="io"><a href="#io" class="header-anchor">#</a> IO</h4> <ol><li><p>IO是Java的输入输出系统。Java使用IO流来处理数据。所谓流就是一系列数据。</p></li> <li><p>IO流根据操作数据类型的不同可分为：字符流和字节流。
根据流向的不同可分为：输入流和输出流。</p></li> <li><p>四大基类：</p> <table><thead><tr><th></th> <th>字节流</th> <th>字符流</th></tr></thead> <tbody><tr><td>输入流</td> <td>InupuStream</td> <td>FileReader</td></tr> <tr><td>输出流</td> <td>OutputStream</td> <td>FileWriter</td></tr></tbody></table></li> <li><p>字节流可以转字符流，但是JAVA没有提供字符流转字节流的方法。原因是因为字节流比字符流使用范围更广，但是字符流比字节流处理文本更加方便。如果能用字符流处理了，也就没有必要转成字节流了。本质上 字符流 = 字节流+编码表。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>   <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;a.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 字节流转字符流</span>
   <span class="token class-name">Reader</span> reader <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>创建输出流对象的时候可以根据File对象创建，也可以直接根据文件名创建。如果文件不存在则会自动创建，文件存在且构造方法没有传入append参数则会创建新文件覆盖掉之前的文件。 而输入流对象如果文件不存在就会报FileNotFound异常。
字节流读取和写入文件：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>   <span class="token comment">//根据文件名创建输出流对象</span>
   <span class="token class-name">OutputStream</span> outputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//根据文件名创建输出流对象，true表明如果文件存在则追加,false表示覆盖</span>
   <span class="token class-name">OutputStream</span> outputStream2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//使用字节数组读取文件</span>
   <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> len<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> inputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// 这里使用0,len是为了读取数组中的有效数据，</span>
        <span class="token comment">//防止最后一次读取时候长度不够而取出之前数组中没替换的数据</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>字节流处理文本解决中文乱码问题的办法就是将读取的字节数组转换成String，String  类里自带解码方法。</p></li> <li><p>字符流读取和写入文件
fileWriter不调用close方法不会将字符写入文件，只是保存在缓冲区，因此如果想继续使用而又不想关闭流就需要调用flush方法。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>   <span class="token comment">//一次读取一个字符</span>
    <span class="token class-name">FileReader</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> b<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">=</span> fileReader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//写入, 输出流会自动创建文件，true表示追加，false表示覆盖</span>
    <span class="token class-name">FileWriter</span> fileWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fileWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;你&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fileWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fileWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;谁&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fileWriter<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fileWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>缓冲流</p> <ul><li>基本原理：1.创建缓冲流时候会内置一个默认大小的缓冲区数组，使用底层流对象从具体设备上获取数据，并将数据存储到缓冲区的数组内。2. 通过缓冲区的read()方法从缓冲区获得具体的字符数据，减少IO次数，提高效率。</li> <li>字节缓冲流： BufferedInputStream, BufferedOutputStream</li> <li>字符缓冲流： BufferedReader, BufferedWriter</li> <li>字符缓冲流特有的方法：readLine() 一次读取一行  newLine()写入换行</li> <li>创建示例</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code>   <span class="token comment">//创建字节缓冲输入流</span>
   <span class="token class-name">BufferedInputStream</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//读取 可以用默认，也可以传入字节数组</span>
   in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token comment">//创建字节缓冲输出流</span>
   <span class="token class-name">BufferedOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">// 创建字符缓冲输入流</span>
   <span class="token class-name">BufferedReader</span> bufferedReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// 字符缓冲输出流</span>
    <span class="token class-name">BufferedWriter</span> bufferedWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>序列化流
ObjectInputStream和ObjectOutStream, 用于将实现了Serializable接口的对象写入文件或者从文件读出来。如果某个属性不需要序列化，就用transient关键字修饰。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>  <span class="token comment">// 序列化流</span>
   <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">ObjectOutputStream</span> dos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">&quot;OBJ.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   p<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">;</span>
   p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
   p<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
   dos<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
   dos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//反序列化</span>
   <span class="token class-name">ObjectInputStream</span> ois <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">&quot;OBJ.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">)</span> ois<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>打印流</p> <ul><li>字节打印流PrintStream, 字符打印流PrintWriter</li> <li>System.out的println和print方法都来自于PrintStream</li> <li>特点： 只操作目的地，不操作数据源。可以操作任意类型的数据。可以操作文件。</li> <li>示例
字节打印流只用把PrintWriter换成PrintStream就行了，其他不变。</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code>  <span class="token comment">//字符打印流</span>
  <span class="token class-name">BufferedReader</span> bufferedReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">PrintWriter</span> printWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span><span class="token string">&quot;copy.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">String</span> line<span class="token punctuation">;</span>
   <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>line <span class="token operator">=</span> bufferedReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       printWriter<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   printWriter<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   printWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>Properties
继承HashTable,线程安全。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>  <span class="token comment">//Properties持久化示例</span>
   <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;12&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">BufferedWriter</span> bufferedWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token string">&quot;nna.properties&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   properties<span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>bufferedWriter<span class="token punctuation">,</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// 读取示例</span>
   <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   properties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token string">&quot;nna.properties&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ol> <h4 id="序列化"><a href="#序列化" class="header-anchor">#</a> 序列化</h4> <ol><li>什么是序列化和反序列化？
序列化：把JAVA对象转换为成字节序列的过程。
反序列化：把字节序列恢复成JAVA对象的过程。</li> <li>什么时候需要序列化？
<ul><li>需要将对象持久化存储</li> <li>在网络上传送对象的字节序列</li></ul></li> <li>如何序列化？
实现Serializable接口</li> <li>serialVersionUID作用
控制序列化的版本。如果不指定serialVersionUID，那么在序列化后修改对象的属性等就会在反序列化时候因版本不一致无法序列化。</li> <li>哪些属性不可序列化？
transient, static修饰的属性不可序列化。</li></ol> <h4 id="nio"><a href="#nio" class="header-anchor">#</a> NIO</h4> <ol><li><p>IO和NIO的区别？</p> <ul><li>IO面向字节流和字符流， NIO面向缓冲区。</li> <li>IO是阻塞模式的，NIO是非阻塞模式的。这意味着当线程调用read或者write方法时候，IO流会被阻塞，直到数据被读取或者完全写入。而NIO允许线程继续执行。。</li></ul></li> <li><p>NIO即New IO或者Non-Blocking IO， 意思是非阻塞的IO，可以替代标准的IO。</p></li> <li><p>核心组件：Channel通道、Buffer缓冲区、Selectors选择器
数据总是从缓冲区写入通道，或者从通道读入缓冲区。</p> <ul><li>主要使用的通道：
FileChannel 文件通道，读写文件
DatagramChannel 通过UDP读写网络中的文件
SocketChannel 通过TCP读写网络中的文件
ServerSocketChannel  监听TCP链接，对每一个新进来的连接都会创建一个SocketChannel。</li> <li>主要使用的缓冲区：
ByteBuffer
CharBuffer
DoubleBuffer
IntBuffer
LongBuffer
ShortBuffer
FloatBuffer
以上各种缓冲区都是对ByteBuffer的封装，方便处理各种类型的数据。还有一个MappedByteBuffer,一般用于和内存映射的文件。</li> <li>选择器：
选择器可以同时监视多个通道，比如数据到达，连接打开等。因此单线程可以监视多个通道的数据。</li></ul></li> <li><p>ByteBuffer的一些方法：</p> <ol><li><p><code>ByteBuffer.allocate(int capacity)</code>和<code>ByteBuffer.allocateDirect(int capacity)</code>
capacity是字节容量大小。 allocate方法表示是在JVM的堆内存上创建缓冲区，allocateDirect表示直接在堆外内存，也就是系统内存创建数组，不受GC管理。
对Java来说，在堆外内存创建和销毁数组的代价更大。
两者的关系：
当数据从通道读入DirectByteBuffer缓冲区时候，是直接使用操作系统的方法，将数据放入堆外内存
当数据从通道读入HeapByteBuffer缓冲区时候，需要先把数据放入堆外内存，然后从堆外内存复制到HeapByteBuffer。</p></li> <li><p>什么时候使用DirectByteBuffer</p> <ul><li>java需要频繁的与操作系统进行IO操作</li> <li>不需要经常创建和销毁DirectByteBuffer</li> <li>DirectByteBuffer不占用堆内存，不受堆大小的限制</li> <li>文件较大的话，不会对GC造成太大的负担</li></ul></li> <li><p>什么时候使用HeapByteBuffer</p> <ul><li>数据仅在Java程序中流转，不与本地IO</li> <li>文件很小</li></ul></li> <li><p>内部一些变量的作用：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//buff即内部用于缓存的数组。</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buff  
<span class="token comment">//当前读取的位置。</span>
position 
<span class="token comment">//为某一读过的位置做标记，便于某些时候回退到该位置。</span>
mark 
<span class="token comment">//初始化时候的容量。</span>
capacity 
<span class="token comment">// 向缓冲区写入数据时候，limit与capacity相等，表示能写入的最大容量</span>
<span class="token comment">// 当从缓冲区读出数据时候， limit与position相等，表示能读取到的写入的全部数据</span>
limit 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>flip方法
读写模式转换，从写模式转换为读模式必须调用这个方法。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>   limit <span class="token operator">=</span> position<span class="token punctuation">;</span>
   position <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   mark <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>利用Buffer读写数据，通常遵循4个步骤：</p> <ul><li>把数据写入buffer</li> <li>调用flip从写模式转换为读模式</li> <li>从Buffer中读取数据</li> <li>调用Buffer.clear()或者Buffer.compact()清空buffer。clear会将buffer数组全部清除，compact则只会清空已读取的数据，未被读取的数据将会被移动到开始位置，写入的数据放在未读数据之后。</li></ul></li> <li><p>Scatter、Gather
Scattering read是指从通道读取的数据能写。入多个缓冲区，也就是一个channel写入多个buffer；
Gathering write指的是从多个缓冲区写入一个通道。
Scattering read示例:
只有前面的buffer写满才会移动到下一个缓冲区。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// RandomAccessFile得到的通道可读写</span>
<span class="token comment">//RandomAccessFile fileInputStream = new RandomAccessFile(&quot;abc.txt&quot;, &quot;rw&quot;);</span>
<span class="token class-name">FileInputStream</span> fileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileChannel</span> inChannel <span class="token operator">=</span> fileInputStream<span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ByteBuffer</span> buffer1 <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ByteBuffer</span> buffer2 <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ByteBuffer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffers <span class="token operator">=</span> <span class="token punctuation">{</span>buffer1<span class="token punctuation">,</span> buffer2<span class="token punctuation">}</span><span class="token punctuation">;</span>
buffer1<span class="token punctuation">.</span><span class="token function">flip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
buffer2<span class="token punctuation">.</span><span class="token function">flip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>buffer1<span class="token punctuation">.</span><span class="token function">hasRemaining</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>buffer1<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>buffer2<span class="token punctuation">.</span><span class="token function">hasRemaining</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>buffer2<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>Gathering write示例：
buffer里有多少数据就会写入多少</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">FileOutputStream</span> fileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">&quot;xyz.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileChannel</span> outChannel <span class="token operator">=</span> fileOutputStream<span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ByteBuffer</span> buffer1 <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ByteBuffer</span> buffer2 <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
buffer1<span class="token punctuation">.</span><span class="token function">putChar</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
buffer2<span class="token punctuation">.</span><span class="token function">putChar</span><span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
buffer2<span class="token punctuation">.</span><span class="token function">putChar</span><span class="token punctuation">(</span><span class="token string">'f'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ByteBuffer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffers <span class="token operator">=</span> <span class="token punctuation">{</span>buffer1<span class="token punctuation">,</span> buffer2<span class="token punctuation">}</span><span class="token punctuation">;</span>
buffer1<span class="token punctuation">.</span><span class="token function">flip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
buffer2<span class="token punctuation">.</span><span class="token function">flip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
outChannel<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffers<span class="token punctuation">)</span><span class="token punctuation">;</span>
outChannel<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li> <li><p>通道之间传递数据
有两种方法：transforTo和transforFrom</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">RandomAccessFile</span> randomAccessFile1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RandomAccessFile</span><span class="token punctuation">(</span><span class="token string">&quot;abc.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;rw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">RandomAccessFile</span> randomAccessFile2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RandomAccessFile</span><span class="token punctuation">(</span><span class="token string">&quot;xyz.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;rw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">FileChannel</span> fileChannel1 <span class="token operator">=</span> randomAccessFile1<span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">FileChannel</span> fileChannel2 <span class="token operator">=</span> randomAccessFile2<span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 通道1的数据传输到通道2有两种方式</span>
<span class="token keyword">long</span> position <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> len <span class="token operator">=</span> fileChannel1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// position表示开始传输的位置，len表示传输的最大长度</span>
fileChannel1<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> len<span class="token punctuation">,</span> fileChannel2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 或者用这个方法，两者是一样的</span>
fileChannel2<span class="token punctuation">.</span><span class="token function">transferFrom</span><span class="token punctuation">(</span>fileChannel1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li> <li><p>Selector选择器
Selector用单个线程管理多个通道。四种通道中，因为FileChannel是阻塞的，所以不能和Selector配合使用。</p> <ul><li>将Channel注册到Selector上
监听类型有4种：
OP_READ 读就绪事件，可以进行读取操作
OP_WRITE 写就绪，可以进行写入
OP_CONNECT 连接继续事件，表示服务器监听到了客户端连接,可以接受这个连接
OP_ACCEPT 连接就绪，服务器收到客户的连接请求会触发</li> <li>ServerSocketChannel的有效事件是OP_ACCEPT，SocketChannel的有效事件是OP_CONNECT、OP_READ、OP_WRITE</li> <li>selector有三种keys:
keys: 保存所有已注册且没被取消的选择键
selectedKeys: 已选择键集,即上一次操作期间，已经准备就绪的通道所对应的选择键
canceledKeys: 已取消但未取消注册的键</li> <li>为什么每次轮询过后都要手动删除selectKeys()的键？
selector不会自己删除selectedKeys()集合中的selectionKey，那么如果不人工remove()，将导致下次select()的时候selectedKeys()中仍有上次轮询留下来的信息</li></ul> <p>一个服务器模板：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">ServerSocketChannel</span> serverSocketChannel <span class="token operator">=</span> <span class="token class-name">ServerSocketChannel</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
serverSocketChannel<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InetSocketAddress</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置非阻塞状态</span>
serverSocketChannel<span class="token punctuation">.</span><span class="token function">configureBlocking</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Selector</span> selector <span class="token operator">=</span> <span class="token class-name">Selector</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
serverSocketChannel<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>selector<span class="token punctuation">,</span> <span class="token class-name">SelectionKey</span><span class="token punctuation">.</span>OP_ACCEPT<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> readyChannel <span class="token operator">=</span> selector<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>readyChannel <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">continue</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SelectionKey</span><span class="token punctuation">&gt;</span></span> selectionKeys <span class="token operator">=</span> selector<span class="token punctuation">.</span><span class="token function">selectedKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SelectionKey</span><span class="token punctuation">&gt;</span></span> keyIterator <span class="token operator">=</span> selectionKeys<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>keyIterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

         <span class="token class-name">SelectionKey</span> selectionKey <span class="token operator">=</span> keyIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionKey<span class="token punctuation">.</span><span class="token function">isAcceptable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;isAcceptable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SocketChannel</span> clientChannel <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ServerSocketChannel</span><span class="token punctuation">)</span> selectionKey<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            clientChannel<span class="token punctuation">.</span><span class="token function">configureBlocking</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            clientChannel<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>selectionKey<span class="token punctuation">.</span><span class="token function">selector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">SelectionKey</span><span class="token punctuation">.</span>OP_READ<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionKey<span class="token punctuation">.</span><span class="token function">isConnectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;isConnectable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionKey<span class="token punctuation">.</span><span class="token function">isReadable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">SocketChannel</span> clientChannel <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SocketChannel</span><span class="token punctuation">)</span> selectionKey<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ByteBuffer</span> byteBuffer <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            clientChannel<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>byteBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>byteBuffer<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionKey<span class="token punctuation">.</span><span class="token function">isWritable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;isWritable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token punctuation">}</span>
         keyIterator<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div></li></ol></li></ol> <h4 id="aio"><a href="#aio" class="header-anchor">#</a> AIO</h4> <p>AIO就是异步IO，从jdk1.7开始</p> <h3 id="泛型"><a href="#泛型" class="header-anchor">#</a> 泛型</h3> <ol><li>泛型就是类型的参数化。</li> <li>实现带有泛型的接口类型时候，如果没有指定接口的泛型类型，那么需要将该接口的实现类定义为泛型类，接口的类型需要在创建类时候才能知道 <code>public class GenericImpl2&lt;T&gt; implements GenericInter&lt;T&gt; {}</code></li> <li>使用通配符的泛型
public void getFunc(List&lt;? extends Animal&gt; an) 表示可以传入Animal或其子类
public void getFunc(Set&lt;? super Animal&gt; an ) 表示可以传入Animal或其父类</li> <li>泛型不支持基本数据类型。泛型不支持继承，使用泛型必须前后保持一致。</li></ol> <h3 id="并发"><a href="#并发" class="header-anchor">#</a> 并发</h3> <h3 id="反射"><a href="#反射" class="header-anchor">#</a> 反射</h3> <h3 id="代理"><a href="#代理" class="header-anchor">#</a> 代理</h3> <h3 id="集合"><a href="#集合" class="header-anchor">#</a> 集合</h3> <p>集合有两大接口，Collection和Map。他们的区别是：</p> <ol><li>Collection是单列集合，Map是双列集合。</li> <li>Collection中只有Set系列要求元素唯一；Map中键需要唯一，值可以重复</li> <li>Collection的数据结构是针对元素的；Map的数据结构是针对键的。</li></ol> <h4 id="collection"><a href="#collection" class="header-anchor">#</a> Collection</h4> <p>包括两大体系，List和Set</p> <p>List：有序，有索引，元素值可以重复</p> <ol><li>List
ArrayList
底层是数组实现，刚创建时候默认为空，添加第一个元素时候初始化为10。
如果指定长度为0，则前几次添加每次都需要扩容。
扩容时每次将原来的数组扩大为1.5倍。
List长度的最大值就是Integer.MAXVALUE</li> <li>LinkedList
底层是双向链表</li></ol> <p>Set：</p> <ol><li>HashSet
无序，元素值不能重复，由HashMap实现。</li> <li>LinkedHashSet
有序，元素不能重复，使用LinkedHashMap实现。</li> <li>TreeSet
存取无序，元素不能重复，可以进行排序,使用TreeMap实现。</li></ol> <p>Collection总结：</p> <ol><li>List 存取有序
ArrayList 数组实现，线程不安全
Vector 数组实现，线程安全
LinkedList 链表实现，线程不安全</li> <li>Set
HashSet 存取无序，元素唯一，HashMap实现，线程不安全
LinkedHashSet 存储有序，元素唯一，LinkedHashMap实现，线程不安全
TreeSet 存储无序，可以排序，使用TreeMap实现</li></ol> <h4 id="map"><a href="#map" class="header-anchor">#</a> Map</h4> <p>Map是双列集合，保存的是键值对，其中key唯一，value可以重复。</p> <ol><li><p>HashMap:
哈希表通过hashcode和equals保证元素唯一。存储自定义对象作为key时候，一定要重写hashcode和equals方法。hashcode和equals方法定义在Object中，每个对象都有这两个方法。</p> <ol><li>装填因子是装入元素的个数与表长的比值，Java默认的装填因子阈值设置为0.75，超过将resize。</li> <li>jdk1.7之前是用数组+链表实现。 1.8时候用数组+链表+红黑树。当链表节点大于8时候，链表才会转换为红黑树,同时链表结构还存在。当链表节点小于等于6时候，红黑树转换为链表.</li> <li>默认容量是 16</li> <li>转换红黑树时候，哈希表的最小长度阈值为64</li> <li>寻找哈希表索引过程：<div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 1. 计算hashcode值 2. 将hashcode值右移16位与原hashcode值做异或</span>
<span class="token comment">//运算得到新的hash值,将高位也参与计算，目的是为了降低 hash 冲突的概率</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> h<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 3. 将hash值与n-1做与运算得到哈希表索引 </span>
n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token comment">//表长</span>
i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">;</span> 
<span class="token comment">//上边的与运算基于这个公式，位运算比取模运算有更快的速度</span>
<span class="token comment">// x mod 2^n = x &amp; (2^n - 1)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li>扩容机制
条件：哈希表中存放的键值对数量超过了阈值
每次扩容2倍，最大容量是Integer.MAXVALUE
扩容后，为什么节点只可能分布在 &quot;原索引位置&quot; 和 &quot;原索引位置+oldCap位置&quot;?<div class="language-java line-numbers-mode"><pre class="language-java"><code>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap <span class="token operator">==</span> <span class="token number">0</span> <span class="token comment">// 表示分布在原索引位置</span>
e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap <span class="token operator">!=</span> <span class="token number">0</span> <span class="token comment">// 表示分布在 原索引+oldCap位置</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div>实际上是由计算规则所简化而来的。 计算索引的方式是 (n-1) &amp; hash,
假设 老表容量是16，新表是32。 那么原来的索引计算方法是 15 &amp; hash, 新索引的计算方法是 31 &amp; hash。 15的二进制数是 1111, 31的二进制数是 11111。显然，索引的计算结果只与5位有关。 假设有两个hashcode，01010，11010, 这两个hash值计算后在老表中的索引一样，在新表中恰好差一个oldCap。又因为第五位恰好是老表的长度oldCap, 10000, 那么将hash值直接和oldCap做与运算，如果是0就是在原位置，如果不为0就是在原位置+oldCap.</li> <li>初始化
new出来时候不会立刻分配地址空间，只有在putVal时候才会分配。即懒加载机制。</li></ol></li> <li><p>LinkedHashMap
基于链表和哈希表实现，存取有序。
LinkedHashMap在HashMap的基础上还维护了一个双向链表。这个链表将元素按照插入顺序或者访问顺序链接起来。
LinkedHashMap实现LRU算法，最近最少访问。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LRUCache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
   
<span class="token keyword">private</span> <span class="token keyword">int</span> cacheSize<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token class-name">LRUCache</span><span class="token punctuation">(</span><span class="token keyword">int</span> cacheSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">0.75f</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cacheSize <span class="token operator">=</span> cacheSize<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
   * 默认返回false,判断元素个数是否超过缓存容量
   */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">removeEldestEntry</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> eldest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> cacheSize<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>双向链表+HashMap实现LRU</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>   <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LRUCache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_CACHE_SIZE<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token class-name">Node</span> head<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token class-name">Node</span> tail<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>

   <span class="token keyword">public</span> <span class="token class-name">LRUCache</span><span class="token punctuation">(</span><span class="token keyword">int</span> max_cache_size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      MAX_CACHE_SIZE <span class="token operator">=</span> max_cache_size<span class="token punctuation">;</span>
      map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      tail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      head<span class="token punctuation">.</span>pre <span class="token operator">=</span> tail<span class="token punctuation">;</span>
      head<span class="token punctuation">.</span>next <span class="token operator">=</span> tail<span class="token punctuation">;</span>
      tail<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">;</span>
      tail<span class="token punctuation">.</span>pre <span class="token operator">=</span> head<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token comment">// 添加一个节点</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">K</span> k<span class="token punctuation">,</span> <span class="token class-name">V</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Node</span> node <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Node</span> newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> newNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addNode</span><span class="token punctuation">(</span>newNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">++</span>count<span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> MAX_CACHE_SIZE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token class-name">Node</span> p <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token operator">--</span>count<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            node<span class="token punctuation">.</span>v <span class="token operator">=</span> v<span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> node<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveToHead</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">K</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Node</span> node <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveToHead</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> node<span class="token punctuation">.</span>v<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">K</span> k<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">Node</span> node <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeNode</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">--</span>count<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Node</span> p <span class="token operator">=</span> head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
      <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> tail<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>v<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            p <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> count<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span> <span class="token class-name">Node</span> <span class="token function">removeLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Node</span> p <span class="token operator">=</span> tail<span class="token punctuation">.</span>pre<span class="token punctuation">;</span>
      p<span class="token punctuation">.</span>pre<span class="token punctuation">.</span>next <span class="token operator">=</span> tail<span class="token punctuation">;</span>
      tail<span class="token punctuation">.</span>pre <span class="token operator">=</span> p<span class="token punctuation">.</span>pre<span class="token punctuation">;</span>
      <span class="token keyword">return</span> p<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">removeNode</span><span class="token punctuation">(</span><span class="token class-name">Node</span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      node<span class="token punctuation">.</span>pre<span class="token punctuation">.</span>next <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
      node<span class="token punctuation">.</span>next<span class="token punctuation">.</span>pre <span class="token operator">=</span> node<span class="token punctuation">.</span>pre<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addNode</span><span class="token punctuation">(</span><span class="token class-name">Node</span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      node<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
      head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>pre <span class="token operator">=</span> node<span class="token punctuation">;</span>
      node<span class="token punctuation">.</span>pre <span class="token operator">=</span> head<span class="token punctuation">;</span>
      head<span class="token punctuation">.</span>next <span class="token operator">=</span> node<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">moveToHead</span><span class="token punctuation">(</span><span class="token class-name">Node</span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeNode</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addNode</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>


   <span class="token comment">// 链表定义</span>
   <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">Node</span> <span class="token punctuation">{</span>
      <span class="token keyword">public</span> <span class="token class-name">Node</span> next<span class="token punctuation">;</span>
      <span class="token keyword">public</span> <span class="token class-name">Node</span> pre<span class="token punctuation">;</span>
      <span class="token keyword">public</span> <span class="token class-name">K</span> k<span class="token punctuation">;</span>
      <span class="token keyword">public</span> <span class="token class-name">V</span> v<span class="token punctuation">;</span>

      <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">}</span>

      <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token class-name">K</span> k<span class="token punctuation">,</span> <span class="token class-name">V</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>k <span class="token operator">=</span> k<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>v <span class="token operator">=</span> v<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br></div></div></li> <li><p>TreeMap
底层使用红黑树，存储时候会排序。查找时间复杂度为O(logn)。排序时候可以自定义比较器。</p></li></ol> <h2 id="java-web基础"><a href="#java-web基础" class="header-anchor">#</a> JAVA Web基础</h2> <p>###　Servlet</p> <ol><li><p>概念： Servlet是Java编写的服务器程序。（单例多线程）</p></li> <li><p>Tomcat的功能： 1.Web服务器 2.Servlet容器</p></li> <li><p>Servlet的生命周期：
分为4个阶段：实例化--&gt;初始化--&gt;执行逻辑--&gt;销毁
一般情况下，servlet只会创建一个实例。
初始化会调用init()方法，init方法只会被在Servlet被创建时候调用，且只会被调用一次。
执行逻辑会调用service方法，每次访问servlet都会调用service方法，service方法会自动去调用对应的doGet或者doPost方法
销毁会调用destory方法，也只会被调用一次。调用后等待垃圾回收器回收。</p></li> <li><p>Servlet的处理过程：</p> <ol><li>客户端发送请求给服务器</li> <li>服务器根据请求去在web.xml中寻找是否有对应的Servlet，如果不存在则返回404</li> <li>找到对应的Servlet后判断是否实例化，如果没有就容器就会加载该Servlet到JVM并实例化</li> <li>调用service方法，并开启一个线程去处理该请求。在service中会根据请求的类型的不同去调用doGet或者doPost等方法</li> <li>业务逻辑处理完成后发送响应结果给客户端。</li></ol></li> <li><p>HttpServletResponse
addHeader(String name, String value) 添加一个消息头
setHeader  覆盖一个消息头，没有就创建
setStatus 设置状态码
sendRedirect
getOutputStream 返回二进制输出流，可以返回任意类型数据（字节或者字符）
getWriter      返回字符流，只能返回字符类型数据
为什么不能同时使用getOutputStream和getWriter？因为Servlet在完成一次服务后会自动关闭流并销毁request和response对象。</p></li> <li><p>乱码处理</p> <ol><li>post  将服务端的编码和浏览器端设置一致　<code>request.setCharacterEncoding(&quot;utf-8&quot;)</code></li> <li>get 手动转换  String str = new String(&quot;xxx&quot;.getBytes(&quot;iso-8859-1&quot;),&quot;utf-8&quot;)</li> <li>sendRedirect重定向乱码， 默认是get，和get处理方法一致</li> <li>返回浏览器显示乱码 response.setContentType(“text/html;charset=utf-8”)</li></ol></li> <li><p>数据传递方式</p> <ol><li>response.sendRedirect  让浏览器重定向到另一个链接。使用重定向不能使用输出流，因为重定向已经将消息返回给浏览器了。</li> <li>request.getRequestDispatcher(资源地址).forward(request,response); 在web服务器内部请求转发，servlet1到servlet2，使用的是相同的request和response</li> <li>request.getSession.setAttribute(key, value)
request.getSession.getAttribute(key)</li> <li>request.setAttribute(key, value) 该方法设置的key-value在request有效期内都能使用，也就是没有将消息返回给浏览器时候。经常和getRequestDispatcher一起使用</li></ol></li> <li><p>sendRedirect和forward的区别</p> <ol><li>sendRedirect重定向能去任何地方，而forward只能服务器端转发</li> <li>前者会改变URL地址，后者不改变</li></ol></li> <li><p>Cookie
应用：记住密码，下次自动登录；购物车；记住浏览数据进行广告推荐
某些网站为了辨别用户身份而储存在用户本地终端上的数据.
因为HTTP是无状态的协议，不能保存用户状态。
cookie在服务器创建，保存在浏览器端
使用setMaxAge(seconds)来设置cookie的生命周期，不设置的话关闭浏览器就清除
seconds = 0,表示删除; seconds &gt; 0 表示seconds秒后删除; seconds &lt; 0 表示会话结束删除，也就是关闭浏览器。
cookie是明文的，因此要加密传输。</p></li> <li><p>Session
Session也是一种会话技术，不同的是，Session保存在服务器端。每个Session对应一个浏览器，JSESSIONID通过cookie传输。Session的根本作用就是在服务端存储用户和服务器会话的一些信息。 应用：判断用户是否登录，购物车</p> <ol><li>Session能够存取任何类型的数据, Cookie只能保存ASCLL字符串</li> <li>Session存储在服务器，Cookie是明文存储在客户端</li> <li>Session的JSESSIONID的过期时间默认为-1，浏览器关闭Session就失效。此外还有超时时间，连续在某个时间内不访问Session就被收回。该超时时间可以在tomcat中配置</li> <li>由于Session保存在服务器端，因此并发很多的话对服务器压力很大，此时用Cookie可能是更好的选择。</li> <li>Cookie支持跨域名访问，Session仅在所在的域名有效。</li> <li>Session的生命周期设置的是用户未操作的时间。</li> <li>生命周期设置优先级顺序为setMaxInactiveInterval &gt; web应用下的web.xml设置 &gt; tomcat/conf/web.xml下的设置</li> <li>通过request.getSession().invalidate()让session中所有属性失效</li> <li>通过request.getSession().removeAttribute()让session中某一属性失效</li> <li>cookie禁用后可以使用URL重写的方法，来实现Session。</li></ol></li> <li><p>Filter
实现Filter接口，主要是对HttpServletRequest进行预处理或者对HttpServletResponse进行后处理。</p></li> <li><p>ServletContext
ServletContext实例通过getServletContext()方法获得。
一个web服务器上的所有Servlet共享一个ServletContext.</p></li></ol> <h3 id="http协议"><a href="#http协议" class="header-anchor">#</a> HTTP协议</h3> <h3 id="tomcat"><a href="#tomcat" class="header-anchor">#</a> Tomcat</h3> <ol><li>更改端口 conf/server.xml 修改Connector的port属性</li> <li></li></ol> <h2 id="java进阶"><a href="#java进阶" class="header-anchor">#</a> JAVA进阶</h2> <h2 id="java-web进阶"><a href="#java-web进阶" class="header-anchor">#</a> JAVA Web进阶</h2> <h2 id="redis，linux-docker等"><a href="#redis，linux-docker等" class="header-anchor">#</a> redis，linux, docker等</h2> <h2 id="其他："><a href="#其他：" class="header-anchor">#</a> 其他：</h2> <h3 id="算法"><a href="#算法" class="header-anchor">#</a> 算法</h3></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">5/5/2020, 6:14:26 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/java/group1/two.html">
        two
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c4ea1501.js" defer></script><script src="/assets/js/2.edc735c2.js" defer></script><script src="/assets/js/29.49e6c8d3.js" defer></script>
  </body>
</html>
